<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport"
		  content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
	<style>
		html, body {
			margin: 0;
			padding: 0;
		}
		a {
			position: absolute;
			color: #fff;
		}
		#canvas {
			position: absolute;
			width: 100%;
			height: 100%;
		}
	</style>
</head>
<body>
<a href="http://blog.mastermaps.com/2013/09/creating-webgl-earth-with-threejs.html">the online manual</a>
<div id="container"></div>
<script src="./lib/three-109/three.min.js"></script>
<script src="./lib/TrackballControls.js"></script>
<script>
    function init() {
        var container = document.getElementById('container');
        var width = window.innerWidth;
        var height = window.innerHeight;

        // init renderer
        var renderer = new THREE.WebGLRenderer();
        renderer.setSize(width, height);
//        renderer.setPixelRatio(window.devicePixelRatio);
//        renderer.setClearColor(0xffffff, 1.0);
        container.appendChild(renderer.domElement);

        // init scene
        var scene = new THREE.Scene();
//        var bgTexture = new THREE.ImageUtils.loadTexture('bg.jpg');
//        scene.background = bgTexture;

        // init camera
        var camera = new THREE.PerspectiveCamera(45, width / height, 0.01, 1000);
//        camera.position.x = 0;
//        camera.position.y = 0;
        camera.position.z = 2.5;

        // init controls
        var controllers = new THREE.TrackballControls(camera);
//        var orbitControl = new THREE.OrbitControls(camera, renderer.domElement);
////            orbitControl.minDistrance = 20;
////            orbitControl.maxDistrance = 50;
//        orbitControl.maxPolarAngle = Math.PI / 2;

        // add light
//        scene.add(new THREE.AmbientLight(0x333333));
//        var light = new THREE.DirectionalLight(0xffffff, 1);
//        light.position.set(5,3,5);
//        scene.add(light);
        var light = new THREE.HemisphereLight(0xffffff, 0x333333, 2);
        light.position.x = 0;
        light.position.y = 0;
        light.position.z = -200;
        scene.add(light);

        // init objects
        var sphere = new THREE.Mesh(
            new THREE.SphereGeometry(0.5, 32, 32),
			new THREE.MeshPhongMaterial({
				map: THREE.ImageUtils.loadTexture('./img/textures/earth_no_clouds_4k.jpg'),
				bumpMap: THREE.ImageUtils.loadTexture('./img/textures/earth_elev_bump_4k.jpg'),
				bumpScale: 0.005,
				specularMap: THREE.ImageUtils.loadTexture('./img/textures/earth_water_4k.png'),
				specular: new THREE.Color('grey')
			})
		)
        scene.add(sphere);

		var clouds = new THREE.Mesh(
		    new THREE.SphereGeometry(0.503, 32, 32),
			new THREE.MeshPhongMaterial({
				map: THREE.ImageUtils.loadTexture('./img/textures/earth_fair_clouds_4k.png'),
				transparent: true
			})
		)
        scene.add(clouds);

		var galaxy = new THREE.Mesh(
            new THREE.SphereGeometry(9, 64, 64),
            new THREE.MeshPhongMaterial({
                map: THREE.ImageUtils.loadTexture('./img/textures/galaxy_starfield.png'),
                side: THREE.BackSide
            })
		)
        scene.add(galaxy);

        // start render
        render()
        function render() {
            controllers.update();
//            group.rotation.y -= 0.0005;
            sphere.rotation.y += 0.005
            clouds.rotation.y += 0.005
            requestAnimationFrame(render);
            renderer.render(scene, camera);
        }

        window.addEventListener('resize', onResize, false);
        function onResize() {
            width = window.innerWidth;
            height = window.innerHeight;
            camera.aspect = width / height;
            camera.updateProjectionMatrix();

            renderer.setSize(width, height);
        }
    }

    window.onload = init;
</script>
</body>
</html>
